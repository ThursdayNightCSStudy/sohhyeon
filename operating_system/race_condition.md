# Race Condition

race condition이란, 여러 프로세스 혹은 스레드가 하나의 자원에 접근하여 결과값에 영향을 줄 수 있는 상태를 말한다. 그 결과 데이터의 일관성을 해칠 수 있다. 

## race condition이 발생하는 경우

- 커널 작업을 수행하는 중 인터럽트가 발생했을때

    - 문제상황: 커널모드에서 데이터를 로드해 작업을 수행하다가 인터럽트가 발생해 같은 데이터를 조작하는 경우.
    - 해결방법: 인터럽트가 발생하지 않도록 인터럽트를 disable 시켜서 CPU 제어권을 가져가지 못하도록 한다.


- 프로세스가 시스템 콜을 호출해 커널모드를 수행하는 도중 context switching이 발생했을때

    - 문제상황: 프로세스 1이 커널모드에서 데이터를 조작하는 도중, 시간이 초과되어 CPU 제어권이 프로세스 2로 넘어가고, 프로세스 2가 같은 데이터를 조작하는 경우.
    - 해결방법: 프로세스가 커널모드에서 작업하는 경우 시간이 초과되어도 CPU 제어권을 넘기지 않도록 한다.

- 멀티 프로세스 환경에서 여러 프로세스가 공유 메모리 내 커널 안 변수에 접근했을때

    - 문제상황: 멀티 프로세스 환경에서 2개의 CPU가 동시에 커널 내부의 공유 데이터에 접근해 조작하는 경우
    - 해결방법: 커널 내부에 있는 각 공유 데이터에 접근할때마다, 그 데이터에 대한 lock/unlock을 한다. 공유 데이터에 접근할 수 있는 프로세스는 하나로 제한.



